--- lesspipe-1.82/lesspipe.sh.in.o3read~	2013-04-26 13:01:26.240565257 +0200
+++ lesspipe-1.82/lesspipe.sh.in	2013-04-26 13:03:42.927856431 +0200
@@ -855,7 +855,7 @@ isfinal() {
     ppthtml "$2" | parsehtml -
 #endif
 #ifdef o3tohtml,unzip
-  elif [[ "$PARSEHTML" = yes && ("$1" = *OpenDocument\ [CHMPST]* || "$1" = *OpenOffice\.org\ 1\.x\ [CIWdgpst]*) ]] && cmd_exist unzip; then
+  elif [[ "$PARSEHTML" = yes && ("$1" = *OpenDocument\ [CHMPST]* || "$1" = *OpenOffice\.org\ 1\.x\ [CIWdgpst]*) ]] && cmd_exist unzip && cmd_exist o3read; then
     if cmd_exist o3tohtml; then
       msg "append $sep to filename to view the OpenOffice or OpenDocument source"
       istemp "unzip -avp" "$2" content.xml | o3tohtml | parsehtml -
